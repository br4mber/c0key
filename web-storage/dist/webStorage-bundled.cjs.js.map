{"version":3,"file":"webStorage-bundled.cjs.js","mappings":"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","sources":["webpack://@tkey/web-storage/webpack/bootstrap","webpack://@tkey/web-storage/webpack/runtime/compat get default export","webpack://@tkey/web-storage/webpack/runtime/define property getters","webpack://@tkey/web-storage/webpack/runtime/hasOwnProperty shorthand","webpack://@tkey/web-storage/webpack/runtime/make namespace object","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/classCallCheck\"","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/createClass\"","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/assertThisInitialized\"","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/inherits\"","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/possibleConstructorReturn\"","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/getPrototypeOf\"","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/defineProperty\"","webpack://@tkey/web-storage/external commonjs2 \"@tkey/common-types\"","webpack://@tkey/web-storage/./src/errors.ts","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/helpers/asyncToGenerator\"","webpack://@tkey/web-storage/external commonjs2 \"@babel/runtime/regenerator\"","webpack://@tkey/web-storage/./src/utils.ts","webpack://@tkey/web-storage/./src/FileStorageHelpers.ts","webpack://@tkey/web-storage/./src/LocalStorageHelpers.ts","webpack://@tkey/web-storage/external commonjs2 \"bn.js\"","webpack://@tkey/web-storage/./src/WebStorageModule.ts","webpack://@tkey/web-storage/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/classCallCheck\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/createClass\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/assertThisInitialized\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/inherits\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/possibleConstructorReturn\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/getPrototypeOf\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/defineProperty\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@tkey/common-types\");","import { ErrorCodes, ITkeyError, TkeyError } from \"@tkey/common-types\";\n\nclass WebStorageError extends TkeyError {\n  protected static messages: ErrorCodes = {\n    3000: \"default\",\n    // module\n    3101: \"unableToReadFromStorage\",\n    // fileStorage\n    3201: \"No Share exists in file system\",\n    3202: \"No requestFileSystem\",\n    // localstorage\n    3301: \"Local storage is not enabled\",\n    3302: \"No share exists in localstorage\",\n  };\n\n  public constructor(code: number, message?: string) {\n    // takes care of stack and proto\n    super(code, message);\n    // Set name explicitly as minification can mangle class names\n    Object.defineProperty(this, \"name\", { value: \"WebStorageError\" });\n  }\n\n  public static fromCode(code: number, extraMessage = \"\"): ITkeyError {\n    return new WebStorageError(code, `${WebStorageError.messages[code]}${extraMessage}`);\n  }\n\n  public static default(extraMessage = \"\"): ITkeyError {\n    return new WebStorageError(3000, `${WebStorageError.messages[3000]}${extraMessage}`);\n  }\n\n  // Custom methods\n  public static unableToReadFromStorage(extraMessage = \"\"): ITkeyError {\n    return WebStorageError.fromCode(3101, extraMessage);\n  }\n\n  public static shareUnavailableInFileStorage(extraMessage = \"\"): ITkeyError {\n    return WebStorageError.fromCode(3201, extraMessage);\n  }\n\n  public static fileStorageUnavailable(extraMessage = \"\"): ITkeyError {\n    return WebStorageError.fromCode(3202, extraMessage);\n  }\n\n  public static localStorageUnavailable(extraMessage = \"\"): ITkeyError {\n    return WebStorageError.fromCode(3301, extraMessage);\n  }\n\n  public static shareUnavailableInLocalStorage(extraMessage = \"\"): ITkeyError {\n    return WebStorageError.fromCode(3302, extraMessage);\n  }\n}\nexport default WebStorageError;\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/asyncToGenerator\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/regenerator\");","export function getWindow(): Window {\n  if (typeof window !== \"undefined\") return window;\n\n  if (typeof self !== \"undefined\") return self;\n  throw new Error(\"Unable to locate window object.\");\n}\n","import { ShareStore } from \"@tkey/common-types\";\n\nimport WebStorageError from \"./errors\";\nimport { getWindow } from \"./utils\";\n\n// Web Specific declarations\nconst requestedBytes = 1024 * 1024 * 10; // 10MB\n\nconst win = getWindow();\nwin.requestFileSystem = win.requestFileSystem || win.webkitRequestFileSystem;\n\ndeclare global {\n  interface Navigator {\n    webkitPersistentStorage: {\n      requestQuota: (a: number, b: (grantedBytes: number) => void, c: (reason: string) => void) => unknown;\n    };\n  }\n}\n\nfunction download(filename: string, text: string): void {\n  const element = document.createElement(\"a\");\n  element.setAttribute(\"href\", `data:application/json;charset=utf-8,${encodeURIComponent(text)}`);\n  element.setAttribute(\"download\", filename);\n  element.style.display = \"none\";\n  document.body.appendChild(element);\n  element.click();\n  document.body.removeChild(element);\n}\nasync function requestQuota(): Promise<number> {\n  return new Promise((resolve, reject) => {\n    navigator.webkitPersistentStorage.requestQuota(requestedBytes, resolve, reject);\n  });\n}\nasync function browserRequestFileSystem(grantedBytes: number): Promise<FileSystem> {\n  return new Promise((resolve, reject) => {\n    win.requestFileSystem(win.PERSISTENT, grantedBytes, resolve, reject);\n  });\n}\nasync function getFile(fs: FileSystem, path: string, create: boolean): Promise<FileEntry> {\n  return new Promise<FileEntry>((resolve, reject) => {\n    fs.root.getFile(path, { create }, (data) => resolve(data as FileEntry), reject);\n  });\n}\nasync function readFile(fileEntry: FileEntry): Promise<File> {\n  return new Promise((resolve, reject) => {\n    fileEntry.file(resolve, reject);\n  });\n}\n\nexport const getShareFromFileStorage = async (key: string): Promise<ShareStore> => {\n  if (win.requestFileSystem) {\n    const fs = await browserRequestFileSystem(requestedBytes);\n\n    const fileEntry = await getFile(fs, key, false);\n    const file = await readFile(fileEntry);\n    const fileStr = await file.text();\n    if (!fileStr) {\n      throw WebStorageError.shareUnavailableInFileStorage();\n    }\n    return ShareStore.fromJSON(JSON.parse(fileStr));\n  }\n  throw WebStorageError.fileStorageUnavailable();\n};\n\nexport const storeShareOnFileStorage = async (share: ShareStore, key: string): Promise<void> => {\n  // if we're on chrome (thus window.requestFileSystem exists) we use it\n  const fileName = `${key}.json`;\n  const fileStr = JSON.stringify(share);\n  if (win.requestFileSystem) {\n    const grantedBytes = await requestQuota();\n    const fs = await browserRequestFileSystem(grantedBytes);\n    const fileEntry = await getFile(fs, key, true);\n    await new Promise((resolve, reject) => {\n      fileEntry.createWriter((fileWriter) => {\n        fileWriter.onwriteend = resolve;\n        fileWriter.onerror = reject;\n        const bb = new Blob([fileStr], { type: \"application/json\" });\n        fileWriter.write(bb);\n      }, reject);\n    });\n  } else {\n    // we make the user download a file\n    download(fileName, fileStr);\n  }\n};\n\nexport const canAccessFileStorage = async (): Promise<PermissionStatus> => navigator.permissions.query({ name: \"persistent-storage\" });\n","import { ShareStore } from \"@tkey/common-types\";\n\nimport WebStorageError from \"./errors\";\nimport { getWindow } from \"./utils\";\n\nconst win = getWindow();\n\nfunction storageAvailable(type: string): boolean {\n  let storage: Storage;\n  try {\n    storage = win[type];\n    const x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return (\n      e instanceof DOMException &&\n      // everything except Firefox\n      (e.code === 22 ||\n        // Firefox\n        e.code === 1014 ||\n        // test name field too, because code might not be present\n        // everything except Firefox\n        e.name === \"QuotaExceededError\" ||\n        // Firefox\n        e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n      // acknowledge QuotaExceededError only if there's something already stored\n      storage &&\n      storage.length !== 0\n    );\n  }\n}\n\nexport const storeShareOnLocalStorage = async (share: ShareStore, key: string): Promise<void> => {\n  const fileStr = JSON.stringify(share);\n  if (!storageAvailable(\"localStorage\")) {\n    throw WebStorageError.localStorageUnavailable();\n  }\n  win.localStorage.setItem(key, fileStr);\n};\n\nexport const getShareFromLocalStorage = async (key: string): Promise<ShareStore> => {\n  if (!storageAvailable(\"localStorage\")) {\n    throw WebStorageError.localStorageUnavailable();\n  }\n  const foundFile = win.localStorage.getItem(key);\n  if (!foundFile) throw WebStorageError.shareUnavailableInLocalStorage();\n  return ShareStore.fromJSON(JSON.parse(foundFile));\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"bn.js\");","import { BNString, DeviceShareDescription, IModule, ITKeyApi, prettyPrintError, ShareStore, StringifiedType } from \"@tkey/common-types\";\nimport BN from \"bn.js\";\n\nimport WebStorageError from \"./errors\";\nimport { canAccessFileStorage, getShareFromFileStorage, storeShareOnFileStorage } from \"./FileStorageHelpers\";\nimport { getShareFromLocalStorage, storeShareOnLocalStorage } from \"./LocalStorageHelpers\";\n\nexport const WEB_STORAGE_MODULE_NAME = \"webStorage\";\n\nclass WebStorageModule implements IModule {\n  moduleName: string;\n\n  tbSDK: ITKeyApi;\n\n  canUseFileStorage: boolean;\n\n  constructor(canUseFileStorage = true) {\n    this.moduleName = WEB_STORAGE_MODULE_NAME;\n    this.canUseFileStorage = canUseFileStorage;\n    this.setFileStorageAccess();\n  }\n\n  async setFileStorageAccess(): Promise<void> {\n    try {\n      const result = await canAccessFileStorage();\n      if (result.state === \"denied\") {\n        this.canUseFileStorage = false;\n      } else if (result.state === \"granted\") {\n        this.canUseFileStorage = true;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      const self = this;\n      result.onchange = function permissionChange() {\n        if (this.state === \"denied\") {\n          self.canUseFileStorage = false;\n        } else if (this.state === \"granted\") {\n          self.canUseFileStorage = true;\n        }\n      };\n    } catch (error) {}\n  }\n\n  setModuleReferences(tbSDK: ITKeyApi): void {\n    this.tbSDK = tbSDK;\n    this.tbSDK._setDeviceStorage(this.storeDeviceShare.bind(this));\n  }\n\n  // eslint-disable-next-line\n  async initialize(): Promise<void> {}\n\n  async storeDeviceShare(deviceShareStore: ShareStore, customDeviceInfo?: StringifiedType): Promise<void> {\n    const metadata = this.tbSDK.getMetadata();\n    const tkeypubx = metadata.pubKey.x.toString(\"hex\");\n    await storeShareOnLocalStorage(deviceShareStore, tkeypubx);\n    const shareDescription: DeviceShareDescription = {\n      module: this.moduleName,\n      userAgent: navigator.userAgent,\n      dateAdded: Date.now(),\n    };\n    if (customDeviceInfo) {\n      shareDescription.customDeviceInfo = JSON.stringify(customDeviceInfo);\n    }\n    await this.tbSDK.addShareDescription(deviceShareStore.share.shareIndex.toString(\"hex\"), JSON.stringify(shareDescription), true);\n  }\n\n  async storeDeviceShareOnFileStorage(shareIndex: BNString): Promise<void> {\n    const metadata = this.tbSDK.getMetadata();\n    const tkeypubx = metadata.pubKey.x.toString(\"hex\");\n    const shareStore = this.tbSDK.outputShareStore(new BN(shareIndex));\n    return storeShareOnFileStorage(shareStore, tkeypubx);\n  }\n\n  async getDeviceShare(): Promise<ShareStore> {\n    const metadata = this.tbSDK.getMetadata();\n    const tkeypubx = metadata.pubKey.x.toString(\"hex\");\n    let shareStore: ShareStore;\n    try {\n      shareStore = await getShareFromLocalStorage(tkeypubx);\n    } catch (localErr) {\n      if (this.canUseFileStorage) {\n        try {\n          shareStore = await getShareFromFileStorage(tkeypubx);\n        } catch (fileErr) {\n          if (fileErr?.message?.includes(\"storage quota\")) {\n            // User has denied access to storage. stop asking for every share\n            this.canUseFileStorage = false;\n          }\n          throw WebStorageError.unableToReadFromStorage(\n            `Error inputShareFromWebStorage: ${prettyPrintError(localErr)} and ${prettyPrintError(fileErr)}`\n          );\n        }\n      }\n      throw WebStorageError.unableToReadFromStorage(`Error inputShareFromWebStorage: ${prettyPrintError(localErr)}`);\n    }\n    return shareStore;\n  }\n\n  async inputShareFromWebStorage(): Promise<void> {\n    const shareStore = await this.getDeviceShare();\n    let latestShareStore = shareStore;\n    const metadata = this.tbSDK.getMetadata();\n    if (metadata.getLatestPublicPolynomial().getPolynomialID() !== shareStore.polynomialID) {\n      latestShareStore = (await this.tbSDK.catchupToLatestShare({ shareStore, includeLocalMetadataTransitions: true })).latestShare;\n      const tkeypubx = metadata.pubKey.x.toString(\"hex\");\n      await storeShareOnLocalStorage(latestShareStore, tkeypubx);\n    }\n    this.tbSDK.inputShareStore(latestShareStore);\n  }\n}\n\nexport default WebStorageModule;\n","export { default as WebStorageError } from \"./errors\";\nexport * from \"./FileStorageHelpers\";\nexport * from \"./LocalStorageHelpers\";\nexport { default, WEB_STORAGE_MODULE_NAME, default as WebStorageModule } from \"./WebStorageModule\";\n"],"names":["TkeyError","WebStorageError","code","message","Object","defineProperty","value","extraMessage","messages","fromCode","getWindow","window","self","Error","ShareStore","requestedBytes","win","requestFileSystem","webkitRequestFileSystem","download","filename","text","element","document","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","requestQuota","Promise","resolve","reject","navigator","webkitPersistentStorage","browserRequestFileSystem","grantedBytes","PERSISTENT","getFile","fs","path","create","root","data","readFile","fileEntry","file","getShareFromFileStorage","key","fileStr","shareUnavailableInFileStorage","fromJSON","JSON","parse","fileStorageUnavailable","storeShareOnFileStorage","share","fileName","stringify","createWriter","fileWriter","onwriteend","onerror","bb","Blob","type","write","canAccessFileStorage","permissions","query","name","storageAvailable","storage","x","setItem","removeItem","e","DOMException","length","storeShareOnLocalStorage","localStorageUnavailable","localStorage","getShareFromLocalStorage","foundFile","getItem","shareUnavailableInLocalStorage","prettyPrintError","BN","WEB_STORAGE_MODULE_NAME","WebStorageModule","canUseFileStorage","moduleName","setFileStorageAccess","result","state","onchange","permissionChange","tbSDK","_setDeviceStorage","storeDeviceShare","bind","deviceShareStore","customDeviceInfo","metadata","getMetadata","tkeypubx","pubKey","toString","shareDescription","module","userAgent","dateAdded","Date","now","addShareDescription","shareIndex","shareStore","outputShareStore","includes","unableToReadFromStorage","getDeviceShare","latestShareStore","getLatestPublicPolynomial","getPolynomialID","polynomialID","catchupToLatestShare","includeLocalMetadataTransitions","latestShare","inputShareStore","default"],"sourceRoot":""}